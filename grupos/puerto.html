<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>SIREX ¬∑ Grupo Puerto</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/puerto.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@700;400&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="../img/logo_cnp.png">
</head>
<body>
  <!-- HEADER -->
  <header class="puerto-header">
    <button class="btn-menu" onclick="window.location.href='../index.html'" title="Volver al men√∫ principal">üè†</button>
    <div class="puerto-logo"><span style="font-size:48px; display:inline-block;">‚öìÔ∏è</span></div>
    <div class="puerto-title">
      <span class="title-main">GRUPO PUERTO</span>
      <span class="title-desc">Control y Estad√≠stica Portuaria</span>
    </div>
    <button id="darkModeBtn" class="modo-oscuro-btn" title="Modo d√≠a/noche">üåô</button>
  </header>

  <main class="main-container">
    <form id="formPuerto" autocomplete="off">
      <section class="panel panel-glass">

        <!-- NUEVA BARRA DE BOTONES ACCI√ìN -->
        <div class="top-actions-bar">
          <button type="button" class="btn-cargar" id="btnCargar" title="Cargar registro del d√≠a"><span>üìÇ</span>Cargar</button>
          <button type="button" class="btn-nuevo" id="btnNuevo" title="Nuevo registro"><span>üÜï</span>Nuevo</button>
          <button type="submit" class="btn-guardar" id="btnGuardarRegistro" title="Guardar"><span>üíæ</span>Guardar</button>
        </div>

        <!-- Fecha -->
        <div class="row-cols fecha-row">
          <label for="fechaPuerto">Fecha del registro</label>
          <input type="date" id="fechaPuerto" required class="form-control input-date">
        </div>

        <!-- Marinos/Cruceros/Visados -->
        <div class="row-cols">
          <div class="form-grid responsive-grid">
            <label for="marinosArgos">Marinos Argos</label>
            <input type="number" min="0" id="marinosArgos" placeholder="Argos">
            <label for="controlPasaportes">Pasaportes Marinos</label>
            <input type="number" min="0" id="controlPasaportes" placeholder="Pasaportes">
            <label for="cruceros">Cruceros</label>
            <input type="number" min="0" id="cruceros" placeholder="Cruceros">
            <label for="cruceristas">Cruceristas</label>
            <input type="number" min="0" id="cruceristas" placeholder="Pasajeros">
            <label for="visadosValencia">Visados Valencia</label>
            <input type="number" min="0" id="visadosValencia" placeholder="Valencia">
            <label for="visadosCG">Visados CG</label>
            <input type="number" min="0" id="visadosCG" placeholder="CG">
            <label for="puertoDeportivo">Puerto Deportivo</label>
            <input type="number" min="0" id="puertoDeportivo" placeholder="Registros">
            <label for="denegaciones">Denegaciones</label>
            <input type="number" min="0" id="denegaciones" placeholder="Denegaciones">
            <label for="certificadosEixics">Certificados EIXICS</label>
            <input type="number" min="0" id="certificadosEixics" placeholder="EIXICS">
          </div>
        </div>

        <!-- NUEVO: FERRYS -->
        <div class="mb-3 ferrys-block">
          <h4>
            FERRYS
            <button class="ayuda-btn" type="button" title="Ayuda sobre ferrys" onclick="alert('A√±ade cada ferry indicando fecha, hora, llegada o salida, pasajeros y veh√≠culos. Puedes ver los ferry [...]
          </h4>
          <!-- Mini-formulario ferry -->
          <div class="ferry-mini-form">
            <select id="ferryTipo" class="form-control" title="Tipo">
              <option value="Llegada">Llegada</option>
              <option value="Salida">Salida</option>
            </select>
            <input type="date" id="ferryFecha" class="form-control" title="Fecha">
            <input type="time" id="ferryHora" class="form-control" title="Hora">
            <input type="number" min="0" id="ferryPasajeros" class="form-control" placeholder="Pasajeros" title="Pasajeros">
            <input type="number" min="0" id="ferryVehiculos" class="form-control" placeholder="Veh√≠culos" title="Veh√≠culos">
            <button type="button" class="btn-add-ferry" id="btnAddFerry">‚ûï A√±adir ferry</button>
          </div>
          <!-- Ventana/listado de ferrys a√±adidos -->
          <div id="ferrysListWindow" class="ventana-ferrys"></div>
          <!-- Totales -->
          <div class="totales-ferry">
            <b>Total ferrys:</b> <span id="totalFerrys">0</span> |
            <b>Total pasajeros:</b> <span id="totalPasajeros">0</span> |
            <b>Total veh√≠culos:</b> <span id="totalVehiculos">0</span>
          </div>
        </div>

        <!-- OBSERVACIONES -->
        <div class="control-group observaciones-box">
          <label for="observaciones">
            Observaciones
            <button class="ayuda-btn" type="button" title="A√±ade cualquier nota relevante" onclick="alert('Aqu√≠ puedes anotar cualquier observaci√≥n relevante, incidencias, etc.')">?</button>
          </label>
          <textarea id="observaciones" class="form-control" placeholder="Observaciones, incidencias..."></textarea>
        </div>

        <!-- Adjuntos -->
        <div class="control-group">
          <label>Adjuntar documentos/im√°genes</label>
          <input type="file" id="adjuntos" class="form-control" multiple accept="image/*,.pdf,.doc,.docx,.xls,.xlsx">
        </div>
      </section>
    </form>

    <!-- RESUMEN AVANZADO / EXPORTACI√ìN -->
    <section class="panel panel-glass mt-4" id="panelResumenAvanzado">
      <h3>Resumen avanzado 
        <button class="ayuda-btn" type="button" title="Resumen y exportaci√≥n" onclick="alert('Puedes generar un resumen por rango de fechas y exportar los datos en PDF, CSV o copiar para WhatsApp.')">?</button>
      </h3>
      <div class="row-cols mb-2 resumen-fechas-row">
        <label for="desdeResumen">Desde</label>
        <input type="date" id="desdeResumen" class="form-control input-date">
        <label for="hastaResumen">Hasta</label>
        <input type="date" id="hastaResumen" class="form-control input-date">
        <button type="button" class="btn-guardar" id="btnGenerarResumen"><i class="bi bi-clipboard-data"></i> Generar resumen</button>
      </div>
      <div class="export-btns resumen-btns-mobile">
        <button id="btnExportarPDF" class="btn btn-pdf" type="button"><i class="bi bi-file-earmark-pdf"></i> Exportar PDF</button>
        <button id="btnExportarCSV" class="btn btn-guardar" type="button"><i class="bi bi-file-earmark-spreadsheet"></i> Exportar CSV</button>
        <button id="btnWhatsapp" class="btn btn-menu" type="button"><i class="bi bi-whatsapp"></i> WhatsApp</button>
      </div>
      <div id="resumenAvanzadoVentana" class="ventana-datos mt-3"></div>
    </section>

    <section class="panel panel-glass mt-4" id="panelResumenPuerto" style="display:none;">
      <h3>Resumen del d√≠a</h3>
      <div id="resumenPuerto"></div>
    </section>
  </main>
  <footer class="footer">
    SIREX ¬∑ UCRIF ¬∑ Grupo Puerto &copy; 2025
  </footer>
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/11.9.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.9.1/firebase-storage-compat.js"></script>
  <script src="puerto.js"></script>
  <script>
    // =========== MODO OSCURO =========== 
    const darkBtn = document.getElementById("darkModeBtn");
    if (darkBtn) {
      darkBtn.onclick = function() {
        document.body.classList.toggle("dark-mode");
        localStorage.setItem("sirex_darkmode", document.body.classList.contains("dark-mode") ? "1" : "0");
        darkBtn.innerText = document.body.classList.contains("dark-mode") ? "‚òÄÔ∏è" : "üåô";
      };
      if (localStorage.getItem("sirex_darkmode") === "1") {
        document.body.classList.add("dark-mode");
        darkBtn.innerText = "‚òÄÔ∏è";
      }
    }
  </script>
</body>
</html>
