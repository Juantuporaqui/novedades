<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>SIREX · Grupo Puerto</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Estilos corporativos -->
  <link rel="stylesheet" href="../css/grupo1.css">
  <link rel="icon" type="image/png" href="../img/logo_cnp.png">
</head>
<body class="bg-police">
  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-police-blue shadow-sm mb-3">
    <div class="container">
      <img src="../img/logo_cnp.png" alt="CNP" width="42" height="42" class="me-2 d-none d-md-block">
      <span class="navbar-brand fs-3 fw-bold">SIREX · Grupo Puerto</span>
      <button id="darkModeBtn" class="modo-oscuro-btn" title="Modo oscuro"><i class="bi bi-moon-stars"></i></button>
      <a href="../index.html" class="btn btn-outline-light ms-auto"><i class="bi bi-house-door"></i> Menú principal</a>
    </div>
  </nav>
  <!-- PARA MÓVIL -->
  <div class="text-center mb-2 d-md-none">
    <a href="../index.html" class="btn btn-outline-primary btn-sm"><i class="bi bi-house-door"></i> Menú principal</a>
  </div>

  <div class="container mb-3">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <div class="card shadow p-3 bg-police-dark text-white border-0">
          <div class="row g-2 align-items-end">
            <div class="col-12 col-sm-4 mb-2 mb-sm-0">
              <label for="fechaPuerto" class="form-label fw-bold mb-1">Fecha de trabajo</label>
              <input type="date" id="fechaPuerto" class="form-control form-control-lg" autocomplete="off" required>
            </div>
            <div class="col-6 col-sm-3">
              <button id="btnCargar" class="btn btn-primary w-100 btn-lg" type="button"><i class="bi bi-search"></i> Cargar</button>
            </div>
            <div class="col-6 col-sm-3">
              <button id="btnNuevo" class="btn btn-secondary w-100 btn-lg" type="button"><i class="bi bi-plus-lg"></i> Nuevo</button>
            </div>
           <div class="col-12 col-sm-2 text-end mt-2 mt-sm-0">
  <button id="btnBorrarRegistro" class="btn btn-police-red w-100 btn-lg" type="button">
    <i class="bi bi-trash"></i> Borrar registro
  </button>
</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- FORMULARIO PRINCIPAL -->
  <div class="container mb-5">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <div class="card shadow-lg p-4">
          <h2 class="mb-4 text-police-blue">
            <i class="bi bi-ship"></i> Estadísticas y novedades Grupo Puerto
          </h2>
          
          <!-- Estadísticas principales -->
          <div class="mb-4">
            <h4 class="mb-2">Estadísticas portuarias</h4>
            <form class="row g-3">
              <div class="col-6 col-md-3">
                <label class="form-label">Ctrl. Marinos</label>
                <input type="number" min="0" id="ctrlMarinos" class="form-control" placeholder="Control Marinos">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Marinos Argos</label>
                <input type="number" min="0" id="marinosArgos" class="form-control" placeholder="Argos">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Cruceros</label>
                <input type="number" min="0" id="cruceros" class="form-control" placeholder="Cruceros">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Cruceristas</label>
                <input type="number" min="0" id="cruceristas" class="form-control" placeholder="Pasajeros">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Visados CGEF</label>
                <input type="number" min="0" id="visadosCgef" class="form-control" placeholder="CGEF">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Visados Valencia</label>
                <input type="number" min="0" id="visadosValencia" class="form-control" placeholder="Valencia">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Visados Expedidos</label>
                <input type="number" min="0" id="visadosExp" class="form-control" placeholder="Expedidos">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Vehículos Chequeados</label>
                <input type="number" min="0" id="vehChequeados" class="form-control" placeholder="Veh.">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Pasajeros Chequeados</label>
                <input type="number" min="0" id="paxChequeadas" class="form-control" placeholder="Pax.">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Detenidos</label>
                <input type="number" min="0" id="detenidos" class="form-control" placeholder="Detenidos">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Denegaciones</label>
                <input type="number" min="0" id="denegaciones" class="form-control" placeholder="Denegaciones">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Entr. Excep.</label>
                <input type="number" min="0" id="entrExcep" class="form-control" placeholder="Entr. Excep.">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">EIXICS</label>
                <input type="number" min="0" id="eixics" class="form-control" placeholder="EIXICS">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Puertos Deportivos</label>
                <input type="number" min="0" id="ptosDeportivos" class="form-control" placeholder="Ptos. Deportivos">
              </div>
            </form>
          </div>

          <!-- Ferrys -->
          <div class="mb-4">
            <h4 class="mb-2">Ferrys
              <button class="ayuda-btn" type="button" title="Ayuda sobre ferrys"
                onclick="alert('Añade cada ferry indicando tipo, destino, fecha, hora, pasajeros, vehículos e incidencia.')">?</button>
            </h4>
            <form class="row g-2 align-items-end" id="ferryForm">
              <div class="col-6 col-md-2">
                <select id="ferryTipo" class="form-select" title="Tipo">
                  <option value="Llegada">Llegada</option>
                  <option value="Salida">Salida</option>
                </select>
              </div>
              <div class="col-6 col-md-2">
                <input type="text" id="ferryDestino" class="form-control" placeholder="Destino" title="Destino">
              </div>
              <div class="col-6 col-md-2">
                <input type="date" id="ferryFecha" class="form-control" title="Fecha">
              </div>
              <div class="col-6 col-md-2">
                <input type="time" id="ferryHora" class="form-control" title="Hora">
              </div>
              <div class="col-6 col-md-2">
                <input type="number" min="0" id="ferryPasajeros" class="form-control" placeholder="Pasaj." title="Pasajeros">
              </div>
              <div class="col-6 col-md-2">
                <input type="number" min="0" id="ferryVehiculos" class="form-control" placeholder="Vehíc." title="Vehículos">
              </div>
              <div class="col-12 col-md-6 mt-2">
                <input type="text" id="ferryIncidencia" class="form-control" placeholder="Incidencia (opcional)" title="Incidencia">
              </div>
              <div class="col-12 col-md-2 d-grid mt-2">
                <button type="button" class="btn btn-police-blue w-100" id="btnAddFerry"><i class="bi bi-plus"></i> Añadir</button>
              </div>
            </form>
            <!-- Listado de ferrys -->
            <div class="ventana-datos ventana-ferrys mt-2" id="ferrysListWindow"></div>
            <div class="totales-ferry">
              Ferrys: <span id="totalFerrys">0</span> |
              Pasaj.: <span id="totalPasajeros">0</span> |
              Vehíc.: <span id="totalVehiculos">0</span>
            </div>
          </div>

          <!-- Observaciones -->
          <div class="mb-4">
            <h4 class="mb-2">Observaciones</h4>
            <textarea id="observaciones" class="form-control" placeholder="Observaciones, incidencias..."></textarea>
          </div>

          <!-- Adjuntos -->
          <div class="mb-4">
            <label class="form-label">Adjuntar doc./imágenes</label>
            <input type="file" id="adjuntos" class="form-control" multiple accept="image/*,.pdf,.doc,.docx,.xls,.xlsx">
          </div>

          <!-- RESUMEN AVANZADO / EXPORTACIÓN -->
          <div class="bg-police-light rounded-3 p-4 mt-5">
            <h4 class="mb-3"><i class="bi bi-clipboard-data"></i> Generar resumen avanzado</h4>
            <div class="row g-3 align-items-end">
              <div class="col-12 col-md-5">
                <label for="desdeResumen" class="form-label">Desde</label>
                <input type="date" id="desdeResumen" class="form-control">
              </div>
              <div class="col-12 col-md-5">
                <label for="hastaResumen" class="form-label">Hasta</label>
                <input type="date" id="hastaResumen" class="form-control">
              </div>
              <div class="col-12 col-md-2 d-grid">
                <button id="btnGenerarResumen" class="btn btn-police-blue w-100" type="button">
                  <i class="bi bi-file-earmark-bar-graph"></i> Resumen
                </button>
              </div>
            </div>
            <div class="export-btns d-flex flex-wrap gap-2 mt-3">
              <button id="btnExportarPDF" class="btn btn-police-yellow" type="button"><i class="bi bi-file-earmark-pdf"></i> PDF</button>
              <button id="btnExportarCSV" class="btn btn-police-green" type="button"><i class="bi bi-file-earmark-spreadsheet"></i> CSV</button>
              <button id="btnWhatsapp" class="btn btn-police-blue" type="button"><i class="bi bi-whatsapp"></i> WhatsApp</button>
            </div>
            <div id="resumenAvanzadoVentana" class="ventana-datos mt-4"></div>
          </div>

          <div id="mensajeGuardado" class="mensaje-guardado"></div>
          <div id="errorMensaje" class="mensaje-error"></div>
          <div id="toast" class="toast"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="footer bg-police-blue text-white text-center py-3 mt-5">
    <small>
      &copy; 2025 UCRIF · Benito · G. Puerto | Plataforma policial
    </small>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Firebase (ajusta si cambias de versión) -->
  <script src="https://www.gstatic.com/firebasejs/11.9.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.9.1/firebase-storage-compat.js"></script>
  <!-- JS Puerto -->
  <script src="../js/puerto.js"></script>
  <script>
    // =========== MODO OSCURO ===========
    const darkBtn = document.getElementById("darkModeBtn");
    if (darkBtn) {
      darkBtn.onclick = function() {
        document.body.classList.toggle("dark-mode");
        localStorage.setItem("sirex_darkmode", document.body.classList.contains("dark-mode") ? "1" : "0");
      };
      if (localStorage.getItem("sirex_darkmode") === "1") {
        document.body.classList.add("dark-mode");
      }
    }
  </script>
</body>
</html>
